import streamlit as st

st.set_page_config(
    page_title="Tolkapy | родрпКро▓рпНроХро╛рокрпНрокро┐роп роЖропрпНро╡рпБ",
    page_icon="ЁЯУЬ",
    layout="centered"
)

st.title("ЁЯУЬ Tolkapy")
st.subheader("родрпКро▓рпНроХро╛рокрпНрокро┐роп ро╡ро┐родро┐ роЖропрпНро╡рпБроХрпН роХро░рпБро╡ро┐")

# -----------------------------
# Try import
# -----------------------------
try:
    from tolkapy import vidhikal
    AVAILABLE_FUNCS = dir(vidhikal)
    status = True
except Exception as e:
    status = False
    st.error(f"тЭМ Tolkapy load роЖроХро╡ро┐ро▓рпНро▓рпИ: {e}")

st.divider()

# -----------------------------
# UI always visible
# -----------------------------
rule = st.selectbox(
    "ЁЯФ╜ роЖропрпНро╡рпБ ро╡ро┐родро┐ропрпИродрпН родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН",
    ["роорпЖропрпНроорпНрооропроХрпНроХроорпН", "роорпКро┤ро┐роорпБродро▓рпН", "роорпКро┤ро┐ропро┐ро▒рпБродро┐", "рокрпБрогро░рпНроЪрпНроЪро┐"]
)

word = st.text_input(
    "ЁЯФд родрооро┐ро┤рпН роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН",
    placeholder="роЙродро╛: роХро▒рпНро▒ро▓рпН"
)

# -----------------------------
# Analyse
# -----------------------------
if st.button("ЁЯФН роЖро░ро╛ропрпНроХ"):

    if not word.strip():
        st.warning("тЪая╕П роТро░рпБ роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН")
    elif not status:
        st.error("тЭМ Tolkapy роирпВро▓роХроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ")
    else:
        try:
            # Dispatcher with safety
            if rule == "роорпЖропрпНроорпНрооропроХрпНроХроорпН":
                if "meymayakkam_checker" in AVAILABLE_FUNCS:
                    result = vidhikal.meymayakkam_checker(word)
                else:
                    st.error("тЭМ роорпЖропрпНроорпНрооропроХрпНроХроорпН function роЗро▓рпНро▓рпИ")
                    st.stop()

            elif rule == "роорпКро┤ро┐роорпБродро▓рпН":
                st.info("тД╣я╕П роорпКро┤ро┐роорпБродро▓рпН ро╡ро┐родро┐ тАУ ро╡ро┐ро░рпИро╡ро┐ро▓рпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпБроорпН")

            elif rule == "роорпКро┤ро┐ропро┐ро▒рпБродро┐":
                st.info("тД╣я╕П роорпКро┤ро┐ропро┐ро▒рпБродро┐ ро╡ро┐родро┐ тАУ ро╡ро┐ро░рпИро╡ро┐ро▓рпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпБроорпН")

            elif rule == "рокрпБрогро░рпНроЪрпНроЪро┐":
                st.info("тД╣я╕П рокрпБрогро░рпНроЪрпНроЪро┐ ро╡ро┐родро┐ тАУ ро╡ро┐ро░рпИро╡ро┐ро▓рпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпБроорпН")

            else:
                st.error("тЭМ роЪрпЖро▓рпНро▓ро╛род ро╡ро┐родро┐")

            if result is True:
                st.success(f"тЬЕ **{word}** тАФ {rule} ро╡ро┐родро┐роХрпНроХрпБ роПро▒рпНрок роЙро│рпНро│родрпБ")
            elif result is not None:
                st.warning(f"тЪая╕П роЖропрпНро╡рпБ роорпБроЯро┐ро╡рпБ: {result}")

        except Exception as e:
            st.error(f"тЭМ роЖропрпНро╡ро┐ро▓рпН рокро┐ро┤рпИ: {e}")

st.divider()
st.caption("ро╡ро┤роЩрпНроХрпБрокро╡ро░рпН: роХрогро┐ропроорпН роЕро▒роХрпНроХроЯрпНроЯро│рпИ & Tolkapy роХрпБро┤рпБ")
