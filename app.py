import streamlit as st
import os
import sys

st.title("ЁЯУЬ родрпКро▓рпНроХро╛рокрпНрокро┐ (Tolkapy)")

# 1. роЪро┐ро╕рпНроЯродрпНродро┐ро▓рпН роЙро│рпНро│ роЕройрпИродрпНродрпБ роирпВро▓роХроЩрпНроХро│рпИропрпБроорпН рокроЯрпНроЯро┐ропро▓ро┐роЯрпНроЯрпБ роЙрогрпНроорпИропро╛рой рокрпЖропро░рпИродрпН родрпЗроЯрпБродро▓рпН
import site
package_path = site.getsitepackages()[0]
all_packages = os.listdir(package_path)

# 2. 'tolkapy' родрпКроЯро░рпНрокро╛рой роЙрогрпНроорпИропро╛рой роГрокрпЛро▓рпНроЯро░рпН рокрпЖропро░рпИродрпН родрпЗроЯрпБродро▓рпН
true_name = None
for pkg in all_packages:
    if 'tolka' in pkg.lower() or 'tamilrule' in pkg.lower():
        if '.dist-info' not in pkg:
            true_name = pkg
            break

if true_name:
    try:
        # роХрогрпНроЯро▒ро┐ропрокрпНрокроЯрпНроЯ рокрпЖропро░ро┐ро▓рпН import роЪрпЖропрпНродро▓рпН
        tolkapy_mod = __import__(true_name)
        st.success(f"роирпВро▓роХроорпН '{true_name}' роОройрпНро▒ рокрпЖропро░ро┐ро▓рпН роХрогрпНроЯро▒ро┐ропрокрпНрокроЯрпНроЯродрпБ!")
        
        # ро╡ро┐родро┐роХро│рпИ роЗро▒роХрпНроХрпБродро▓рпН
        from tolkapy import vidhikal
        
        word = st.text_input("роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН:", "родрооро┐ро┤рпН")
        if st.button("роЪро░ро┐рокро╛ро░рпН"):
            # роирпВро▓роХродрпНродро┐ро▓рпН роЙро│рпНро│ роЪро░ро┐ропро╛рой ро╡ро┐родро┐ропрпИ роЕро┤рпИродрпНродро▓рпН
            res = vidhikal.tamil_word_checker(word)
            st.info(f"роорпБроЯро┐ро╡рпБ: {res}")
            
    except Exception as e:
        st.error(f"рокро┐ро┤рпИ: {e}")
        st.write("роЙро│рпНро│рпЗ роЗро░рпБроХрпНроХрпБроорпН роХрпЛрокрпНрокрпБроХро│рпН:", dir(tolkapy_mod) if 'tolkapy_mod' in locals() else "роЗро▓рпНро▓рпИ")
else:
    # 3. роТро░рпБро╡рпЗро│рпИ рокрпЖропро░рпЗ родрпЖро░ро┐ропро╡ро┐ро▓рпНро▓рпИ роОройрпНро▒ро╛ро▓рпН роирпЗро░роЯро┐ропро╛роХ tamilrulepy роОрой роорпБропро▒рпНроЪро┐рокрпНрокрпЛроорпН
    try:
        import tamilrulepy as tolkapy
        from tamilrulepy import vidhikal
        st.success("роирпВро▓роХроорпН 'tamilrulepy' роОройрпНро▒ рокро┤рпИроп рокрпЖропро░ро┐ро▓рпН роЗропроЩрпНроХрпБроХро┐ро▒родрпБ!")
        # роорпЗро▓рпЗ роЙро│рпНро│ роЕродрпЗ UI-роР роЗроЩрпНроХрпБроорпН рокропройрпНрокроЯрпБродрпНродро▓ро╛роорпН
    except ImportError:
        st.error("рооройрпНройро┐роХрпНроХро╡рпБроорпН! роирпВро▓роХроорпН роиро┐ро▒рпБро╡рокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ, роЖройро╛ро▓рпН роЕродройрпН роЪро░ро┐ропро╛рой 'Import' рокрпЖропро░рпИ рокрпИродрпНродро╛ройро╛ро▓рпН роХрогрпНроЯрпБрокро┐роЯро┐роХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ.")
        st.write("роиро┐ро▒рпБро╡рокрпНрокроЯрпНроЯрпБро│рпНро│ роХрпЛрокрпНрокрпБроХро│рпН:", all_packages[:20]) # роорпБродро▓рпН 20-роР роороЯрпНроЯрпБроорпН роХро╛роЯрпНроЯрпБроорпН

st.divider()
st.caption("роХрогро┐ропроорпН роЕро▒роХрпНроХроЯрпНроЯро│рпИ ро╡рпЖро│ро┐ропрпАроЯрпБ")
