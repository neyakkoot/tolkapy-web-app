import streamlit as st
import sys
import subprocess

# 1. рокроХрпНроХ ро╡роЯро┐ро╡роорпИрокрпНрокрпБ
st.set_page_config(page_title="родрпКро▓рпНроХро╛рокрпНрокро┐ - роорпЖропрпНрооропроХрпНроХроорпН", page_icon="ЁЯУЬ")

# 2. роирпВро▓роХродрпНродрпИ ро╡ро▓рпБроХрпНроХроЯрпНроЯро╛ропрооро╛роХроЪрпН роЪро░ро┐рокро╛ро░рпНродрпНродрпБ роЗро▒роХрпНроХрпБродро▓рпН
@st.cache_resource
def load_lib():
    try:
        # роорпБродро▓ро┐ро▓рпН роирпЗро░роЯро┐ропро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ро▒рпЛроорпН
        from tamilrulepy import vidhikal
        return vidhikal
    except ImportError:
        # роЪро┐роХрпНроХро▓рпН роЗро░рпБроирпНродро╛ро▓рпН роорпАрогрпНроЯрпБроорпН роиро┐ро▒рпБро╡ро┐ роЗро▒роХрпНроХрпБроХро┐ро▒рпЛроорпН
        subprocess.check_call([sys.executable, "-m", "pip", "install", "tolkapy", "open-tamil"])
        from tamilrulepy import vidhikal
        return vidhikal

try:
    vidhikal = load_lib()
    st.success("тЬЕ роЗро▓роХрпНроХрог ро╡ро┐родро┐роХро│рпН родропро╛ро░рпН!")
except Exception as e:
    st.error(f"тЭМ роирпВро▓роХродрпНродрпИ роЗрогрпИрокрпНрокродро┐ро▓рпН роЪро┐роХрпНроХро▓рпН: {e}")
    st.stop()

# 3. рокропройро░рпН роЗроЯрпИроорпБроХроорпН
st.title("ЁЯУЬ родрпКро▓рпНроХро╛рокрпИ (Tolkapy)")
st.subheader("родрооро┐ро┤рпН роорпЖропрпНрооропроХрпНроХроорпН ро╡ро┐родро┐ роЪро░ро┐рокро╛ро░рпНрокрпНрокро╛ройрпН")

word = st.text_input("роЪро░ро┐рокро╛ро░рпНроХрпНроХ ро╡рпЗрогрпНроЯро┐роп родрооро┐ро┤рпН роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН:", "родрооро┐ро┤рпН")

if st.button("роЪро░ро┐рокро╛ро░рпН"):
    if word:
        try:
            # роиро╛роорпН роорпБройрпНрокрпБ роХрогрпНроЯро▒ро┐роирпНрод meymayakkam_checker роЪро╛ро░рпНрокрпБ
            result = vidhikal.meymayakkam_checker(word)
            
            if result == True or result == "True":
                st.balloons()
                st.success(f"тЬЕ '{word}' - роорпЖропрпНрооропроХрпНроХроорпН ро╡ро┐родро┐роХро│ро┐ройрпНрокроЯро┐ роЪро░ро┐ропро╛рой роЪрпКро▓рпН.")
            else:
                st.warning(f"тЪая╕П роЖропрпНро╡рпБ роорпБроЯро┐ро╡рпБ: {result}")
                
            st.info("родрпКро▓рпНроХро╛рокрпНрокро┐роп роорпЖропрпНрооропроХрпНроХроорпН ро╡ро┐родро┐роХро│ро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН роЗроирпНрод роЖропрпНро╡рпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ.")
        except Exception as e:
            st.error(f"роЖропрпНро╡рпБ роЪрпЖропрпНро╡родро┐ро▓рпН рокро┐ро┤рпИ: {e}")
    else:
        st.info("родропро╡рпБроЪрпЖропрпНродрпБ роТро░рпБ роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН.")

st.divider()
st.caption("роиройрпНро▒ро┐: роХрогро┐ропроорпН роЕро▒роХрпНроХроЯрпНроЯро│рпИ & Tolkapy роХрпБро┤рпБро╡ро┐ройро░рпН")
