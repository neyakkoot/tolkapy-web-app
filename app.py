import streamlit as st

# -------------------------------------------------
# рокроХрпНроХ ро╡роЯро┐ро╡роорпИрокрпНрокрпБ (Page Configuration)
# -------------------------------------------------
st.set_page_config(
    page_title="Tolkapy | родрпКро▓рпНроХро╛рокрпНрокро┐роп роЖропрпНро╡рпБ",
    page_icon="ЁЯУЬ",
    layout="wide"
)

# -------------------------------------------------
# Tolkapy роирпВро▓роХродрпНродрпИ роЗро▒роХрпНроХрпБроородро┐ роЪрпЖропрпНродро▓рпН
# -------------------------------------------------
try:
    import tolkapy
    from tolkapy import vidhikal
    status = True
except Exception as e:
    status = False
    error_msg = e

# -------------------------------------------------
# рокроХрпНроХродрпН родро▓рпИрокрпНрокрпБ
# -------------------------------------------------
st.title("ЁЯУЬ Tolkapy (родрпКро▓рпНроХро╛рокрпНрокро┐)")
st.subheader("родрпКро▓рпНроХро╛рокрпНрокро┐роп роЗро▓роХрпНроХрог ро╡ро┐родро┐ роЖропрпНро╡рпБроХрпН роХро░рпБро╡ро┐")
st.markdown("родрооро┐ро┤рпН роЪрпКро▒рпНроХро│рпН родрпКро▓рпНроХро╛рокрпНрокро┐роп ро╡ро┐родро┐роХро│рпБроХрпНроХрпБ роЙроЯрпНрокроЯрпНроЯрпБро│рпНро│ройро╡ро╛ роОройрпНрокродрпИ роЖро░ро╛роп роЙродро╡рпБроорпН роТро░рпБ роорпЖройрпНрокрпКро░рпБро│рпН.")
st.divider()

# ---------------- : Tolkapy роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ роОройро┐ро▓рпН : ----------------
if not status:
    st.error(f"тЭМ Tolkapy роирпВро▓роХродрпНродрпИ роПро▒рпНро▒ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ: {error_msg}")
    st.info("роЙроЩрпНроХро│рпБроЯрпИроп `requirements.txt` роХрпЛрокрпНрокро┐ро▓рпН `tolkapy` роЪро░ро┐ропро╛роХ роЙро│рпНро│родро╛ роОройрокрпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН.")
    st.stop()

# -------------------------------------------------
# рокроХрпНроХро╡ро╛роЯрпНроЯрпБрокрпН рокроЯрпНроЯро┐ (Sidebar)
# -------------------------------------------------
with st.sidebar:
    st.header("тЪЩя╕П роЕроорпИрокрпНрокрпБроХро│рпН")
    rule = st.selectbox(
        "роЖропрпНро╡рпБ ро╡ро┐родро┐ропрпИродрпН родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН",
        [
            "роорпЖропрпНроорпНрооропроХрпНроХроорпН (Meimmayakkam)",
            "роорпКро┤ро┐роорпБродро▓рпН (Word Initial)",
            "роорпКро┤ро┐ропро┐ро▒рпБродро┐ (Word Final)",
            "рокрпБрогро░рпНроЪрпНроЪро┐ (Sandhi - ро╡ро┐ро░рпИро╡ро┐ро▓рпН)"
        ]
    )
    st.divider()
    st.info("роЗроирпНродроХрпН роХро░рпБро╡ро┐ роХрогро┐ропроорпН роЕро▒роХрпНроХроЯрпНроЯро│рпИропро┐ройрпН Tolkapy родро┐роЯрпНроЯродрпНродро┐ройрпН роТро░рпБ рокроХрпБродро┐ропро╛роХрпБроорпН.")

# -------------------------------------------------
# родро░ро╡рпБ роЙро│рпНро│рпАроЯрпБ рооро▒рпНро▒рпБроорпН роЖропрпНро╡рпБ
# -------------------------------------------------
col1, col2 = st.columns([1, 1])

with col1:
    word = st.text_input(
        "ЁЯФд родрооро┐ро┤рпН роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН:",
        placeholder="роЙродро╛: родроЩрпНроХроорпН, роХро▒рпНро▒ро▓рпН"
    )
    analyse_btn = st.button("ЁЯФН роЖро░ро╛ропрпНроХ")

with col2:
    if analyse_btn:
        if not word.strip():
            st.warning("тЪая╕П родропро╡рпБроЪрпЖропрпНродрпБ роТро░рпБ родрооро┐ро┤рпН роЪрпКро▓рпНро▓рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН")
        else:
            try:
                st.write(f"### роЖропрпНро╡рпБ роорпБроЯро┐ро╡рпБ ({rule}):")
                
                if rule == "роорпЖропрпНроорпНрооропроХрпНроХроорпН (Meimmayakkam)":
                    result = vidhikal.meymayakkam_checker(word)
                elif rule == "роорпКро┤ро┐роорпБродро▓рпН (Word Initial)":
                    result = vidhikal.mozhi_muthal_checker(word)
                elif rule == "роорпКро┤ро┐ропро┐ро▒рпБродро┐ (Word Final)":
                    result = vidhikal.mozhi_iruthi_checker(word)
                else:
                    result = "роЗроирпНрод ро╡роЪродро┐ роЗройрпНройрпБроорпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ."

                # роорпБроЯро┐ро╡рпИроХрпН роХро╛роЯрпНроЯрпБродро▓рпН
                if result is True:
                    st.success(f"тЬЕ **'{word}'** тАФ ро╡ро┐родро┐роХрпНроХрпБ роПро▒рпНрок роЪро░ро┐ропро╛роХ роЙро│рпНро│родрпБ!")
                    st.balloons()
                elif result is False:
                    st.error(f"тЭМ **'{word}'** тАФ ро╡ро┐родро┐роХро│ро┐ройрпНрокроЯро┐ роЕроорпИропро╡ро┐ро▓рпНро▓рпИ.")
                else:
                    st.warning(f"ЁЯТб родроХро╡ро▓рпН: {result}")

            except Exception as e:
                st.error(f"тЭМ роЖропрпНро╡ро┐ройрпН рокрпЛродрпБ рокро┐ро┤рпИ роПро▒рпНрокроЯрпНроЯродрпБ: {e}")

# -------------------------------------------------
# роЕроЯро┐роХрпНроХрпБро▒ро┐рокрпНрокрпБ (Footer)
# -------------------------------------------------
st.divider()
st.caption("роЙро░рпБро╡ро╛роХрпНроХроорпН: роорпБройрпИро╡ро░рпН роЪродрпНродро┐ропро░ро╛роЪрпБ родроЩрпНроХроЪрпНроЪро╛рооро┐ропрпБроорпН роЕро╡ро░рпНродроорпН Tolkapy роХрпБро┤рпБро╡ро┐ройро░рпБроорпН, роХрогро┐ропроорпН роЕро▒роХрпНроХроЯрпНроЯро│рпИ | [GitHub](https://github.com/neyakkoot/tolkapy-web-app)")
